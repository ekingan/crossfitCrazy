<div class="handstand-background"></div>
	<span class="pull-left"><%= link_to 'Back to Results', :back, class: 'btn btn-primary btn-sm' %>
	</span>
	<div class="container">
		<div class="row"><!-- row 1 -->
			<div class="col-md-6"> <!-- column 1 -->
			<!-- Gym show  -->
				<h3><%=@gym.name%></h3>
					<h4><%= @gym.address %></h4>
					<h4><%= @gym.website %></h4>
					<h4><%= @gym.phone %></h4>
					<h5><%= @gym.w_vs_m %></h5>	
				<div class="table-responsive">
					<div class="table table-condensed">
						<table style="width:100%">
				  		<tr>
				    		<td>Programming</td>
								<td>Community</td>
								<td>Facility</td>
								<td>Value</td>
				  		</tr>
				  		<tr>
				   			<td><div class="star-rating-pro" data-score=<%= @gym.avg_rating(:programming) %>></div></td>
								<td><div class="star-rating-com" data-score=<%= @gym.avg_rating(:community) %>></div></td>
								<td><div class="star-rating-fac" data-score=<%= @gym.avg_rating(:facility) %>></div></td>
								<td><div class="star-rating-val" data-score=<%= @gym.avg_rating(:value) %>></div></td>
				  		</tr>
				  		<tr>
								<td><em><%= "#{@gym.reviews.length} reviews" %></em><br></td>
								<td></td>
								<td></td>
								<td></td>
							</tr>
						</table>
					</div>
				</div><!-- end gym show table -->
				<!-- 	BEGIN map -->
				<div style='width: 800px;'>
		  		<div id="map" style='width: 50%; height: 200px;'></div>
				</div><!-- END map -->
				<br>
					<% if @user %>
					<span class="pull-left"><%= link_to 'Update Gym Info', edit_gym_path, class: 'btn btn-primary btn-sm' %>
					</span>
				  <% end %><!-- end gym show -->
		 	</div><!-- end column 1 -->
			<br>
			<br>
			<div class="col-md-6">
				<div class="well well-sm">
				<% if @user %>
				<span class="pull-right"><%= link_to 'Write a Review', new_review_path, class: 'btn btn-primary btn-sm' %>
				</span>
				<% end %>
				<% if @reviews.count < 1  %>
					<h3><%= @no_reviews %></h3>
					<% else %>
						<% @reviews.reverse.each do |review|  %>
						<% user_id = review.user_id %>
							<% author = User.find(user_id) %>
						<ul class='list-unstyled'>
							<li class='list-unstyled'>
								<h5>Posted by <%= author.username %> on <%= review.created_at.strftime("%B %d, %Y") %></h5>
								<h5><%= review.body %></h5>
									<div class="table-responsive">
										<div class="table table-condensed">
											<table style="width:100%">
									  		<tr>
									    		<td>Programming</td>
													<td>Community</td>
													<td>Facility</td>
													<td>Value</td>
									  		</tr>
									  		<tr>
									  			<td><div class="star-rating-pro" data-score=<%= review.programming %>></div></td>
													<td><div class="star-rating-com" data-score=<%= review.community %>></div></td>
													<td><div class="star-rating-fac" data-score=<%= review.facility %>></div></td>
													<td><div class="star-rating-val" data-score=<%= review.value %>></div></td>
												</tr>
											</table>
										</div>
									</div>
					 				<span class="pull-right">
					 				<% if @user %>
			      			<%= link_to '', "/reviews/#{review.id}/edit", class: 'ion ion-edit' %>
			      			<% end %>
			     				</span>
			     		</li>
						</ul>	
			  </div> <!-- END WELL -->
			 </div> <!-- END COL-->
		  <!-- end of reviews show -->	
		</div> <!-- end of row-->
			<% end %>
			<% end %>
		
	</div><!-- end of container -->


<!-- script for making rating on stars -->
<script>
	$('#star-rating-pro').raty({ 
		// path: '/assets/', 
		scoreName: 'review[programming]'
	});
</script>
<script>
	$('#star-rating-fac').raty({
		// path: '/assets/', 
		scoreName: 'review[facility]'
	});
</script>
<script>
	$('#star-rating-val').raty({
		// path: '/assets/', 
		scoreName: 'review[value]'
	});
</script>
<script>
	$('#star-rating-com').raty({
		// path: '/assets/', 
		scoreName: 'review[community]'
	});
</script>
<!-- Script for displaying rating -->
<script>
	$('.star-rating-pro').raty({
		// path: '/assets/',
		readOnly: true,
		score: function() {
			return $(this).attr('data-score');
		}
	});
</script>
<script>
	$('.star-rating-fac').raty({
		// path: '/assets/',
		readOnly: true,
		score: function() {
			return $(this).attr('data-score');
		}
	});
</script>
<script>
	$('.star-rating-val').raty({
		// path: '/assets/',
		readOnly: true,
		score: function() {
			return $(this).attr('data-score');
		}
	});
</script>
<script>
	$('.star-rating-com').raty({
		// path: '/assets/', 
		readOnly: true,
		score: function() {
			return $(this).attr('data-score');
		}
	});
</script>

<script type='text/javascript'>
	handler = Gmaps.build('Google');
	handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
  markers = handler.addMarkers([
    {
      "lat": <%= @gym.lat %>,
      "lng": <%= @gym.long %>,
      "picture": {
        "url": "http://google-maps-icons.googlecode.com/files/gym.png",
        "width":  32,
        "height": 32
      },
      "infowindow": ""
    }
  ]);
  handler.bounds.extendWith(markers);
  handler.fitMapToBounds();
  handler.getMap().setZoom(14);
});
</script>
<script>
    markers = handler.addMarkers(<%=raw @hash.to_json %>);
</script>

